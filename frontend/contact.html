{% extends "base.html" %}

{% block title %}Contact Us - Norshel Inc.{% endblock %}

{% block content %}
<!-- Custom Background for Contact Page -->
<style>
    .page-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        background-image: url('/static/background.jpg');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        background-attachment: fixed;
    }
    
    .page-background::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(1px);
    }
    
    .content-section {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(5px);
        border-radius: 1rem;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 2rem;
        padding: 2rem;
    }
</style>

<!-- Background Image -->
<div class="page-background"></div>
<div class="max-w-4xl mx-auto">
    <h1 class="text-4xl font-bold text-primary mb-8 text-center">Contact Us</h1>

    <div class="grid md:grid-cols-2 gap-8">
        <!-- Kernaghan Location -->
        <div class="content-section bg-white rounded-lg shadow-md p-8">
            <h2 class="text-2xl font-semibold text-primary mb-4">Kernaghan Location</h2>
            <div class="prose max-w-none text-gray-700">
                <div class="mb-6">
                    <p class="font-semibold mb-2">Norshel Centre</p>
                    <p>73-630 Kernaghan Avenue</p>
                    <p>Winnipeg, Manitoba</p>
                    <p>R2C 5G1</p>
                    <p class="mt-2">
                        <span class="font-semibold">Phone:</span> 
                        <a href="tel:2046546117" class="text-primary hover:underline">(204) 654-6117</a>
                    </p>
                </div>

                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-primary mb-2">Mailing Address</h3>
                    <p>P.O. 4-630 Kernaghan Avenue</p>
                    <p>Winnipeg, Manitoba</p>
                    <p>R2C 5G1</p>
                </div>

                <div class="mt-6">
                    <a href="https://maps.google.com/?q=73-630+Kernaghan+Avenue+Winnipeg+Manitoba+R2C+5G1" 
                       target="_blank" 
                       class="inline-block bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark transition-colors">
                        Get Directions
                    </a>
                </div>
            </div>
        </div>

        <!-- Scurfield Location -->
        <div class="content-section bg-white rounded-lg shadow-md p-8">
            <h2 class="text-2xl font-semibold text-primary mb-4">Scurfield Location</h2>
            <div class="prose max-w-none text-gray-700">
                <div class="mb-6">
                    <p class="font-semibold mb-2">Norshel Centre</p>
                    <p>20-5 Scurfield Blvd</p>
                    <p>Winnipeg, Manitoba</p>
                    <p>R3Y 1G3</p>
                    <p class="mt-2">
                        <span class="font-semibold">Phone:</span> 
                        <a href="tel:2044529955" class="text-primary hover:underline">(204) 452-9955</a>
                    </p>
                </div>

                <div class="mt-6">
                    <a href="https://maps.google.com/?q=20-5+Scurfield+Blvd+Winnipeg+Manitoba+R3Y+1G3" 
                       target="_blank" 
                       class="inline-block bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark transition-colors">
                        Get Directions
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Form -->
    <div class="content-section mt-12 bg-white rounded-lg shadow-md p-8">
        <h2 class="text-2xl font-semibold text-primary mb-6">Send Us a Message</h2>
        <form id="contactForm" class="space-y-6" enctype="multipart/form-data">
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <label for="name" class="block text-gray-700 mb-2">Name</label>
                    <input type="text" id="name" name="name" required
                        class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
                </div>
                <div>
                    <label for="email" class="block text-gray-700 mb-2">Email</label>
                    <input type="email" id="email" name="email" required
                        class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
                </div>
            </div>
            <div>
                <label for="subject" class="block text-gray-700 mb-2">Subject</label>
                <input type="text" id="subject" name="subject" required
                    class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
            </div>
            <div>
                <label for="message" class="block text-gray-700 mb-2">Message</label>
                <textarea id="message" name="message" rows="4" required
                    class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"></textarea>
            </div>
            <div>
                <label for="image" class="block text-gray-700 mb-2">Attach Image (Optional)</label>
                <input type="file" id="image" name="image" accept="image/*"
                    class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
                <p class="text-sm text-gray-500 mt-1">Supported formats: JPG, PNG, GIF</p>
            </div>
            <button type="submit" id="submitBtn"
                class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                Send Message
            </button>
            <div id="formMessage" class="hidden p-4 rounded-lg"></div>
        </form>
    </div>

    <!-- Map -->
    <div class="content-section mt-12 bg-white rounded-lg shadow-md p-8">
        <h2 class="text-2xl font-semibold text-primary mb-6 text-center">üìç Find Us on the Map</h2>
        <div class="grid md:grid-cols-2 gap-8 mb-6">
            <!-- Kernaghan Location Map -->
            <div>
                <h3 class="text-lg font-semibold text-primary mb-4">Kernaghan Location</h3>
                <div class="relative w-full rounded-lg border-2 border-gray-200 overflow-hidden" style="padding-top: 75%;">
                    <img src="/static/630 Kernaghan Ave.jpg" 
                         alt="Map showing 630 Kernaghan Ave #73, Winnipeg"
                         class="absolute inset-0 w-full h-full object-cover">
                </div>
                <div class="mt-3 text-center">
                    <a href="https://maps.google.com/?q=630+Kernaghan+Ave+%2373,+Winnipeg,+MB+R2C+5G1" 
                       target="_blank" 
                       class="inline-flex items-center text-primary hover:underline text-sm font-semibold">
                        <span class="mr-1">üó∫Ô∏è</span>
                        Open in Google Maps
                    </a>
                </div>
            </div>

            <!-- Scurfield Location Map -->
            <div>
                <h3 class="text-lg font-semibold text-primary mb-4">Scurfield Location</h3>
                <div class="relative w-full rounded-lg border-2 border-gray-200 overflow-hidden" style="padding-top: 75%;">
                    <img src="/static/5 Scurfield Blvd.jpg" 
                         alt="Map showing 5 Scurfield Blvd #20, Winnipeg"
                         class="absolute inset-0 w-full h-full object-cover">
                </div>
                <div class="mt-3 text-center">
                    <a href="https://maps.google.com/?q=5+Scurfield+Blvd+%2320,+Winnipeg,+MB+R3Y+1G3" 
                       target="_blank" 
                       class="inline-flex items-center text-primary hover:underline text-sm font-semibold">
                        <span class="mr-1">üó∫Ô∏è</span>
                        Open in Google Maps
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Alternative if maps don't load -->
        <div class="bg-blue-50 p-4 rounded-lg text-center">
            <p class="text-sm text-gray-700 mb-2">
                <strong>Can't see the maps?</strong> Click the links above to open in Google Maps directly.
            </p>
            <div class="flex justify-center space-x-4">
                <a href="https://maps.google.com/?q=630+Kernaghan+Ave+%2373,+Winnipeg,+MB+R2C+5G1" 
                   target="_blank" 
                   class="text-primary hover:underline font-semibold">
                    üìç Kernaghan Location
                </a>
                <span class="text-gray-400">|</span>
                <a href="https://maps.google.com/?q=5+Scurfield+Blvd+%2320,+Winnipeg,+MB+R3Y+1G3" 
                   target="_blank" 
                   class="text-primary hover:underline font-semibold">
                    üìç Scurfield Location
                </a>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('contactForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    const formMessage = document.getElementById('formMessage');
    const originalText = submitBtn.textContent;
    
    // Show loading state
    submitBtn.textContent = 'Sending...';
    submitBtn.disabled = true;
    formMessage.classList.add('hidden');
    
    try {
        const formData = new FormData(this);
        
        const response = await fetch('/api/contact', {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (response.ok && result.success) {
            // Success
            formMessage.textContent = result.message;
            formMessage.className = 'p-4 rounded-lg bg-green-100 text-green-700 border border-green-200';
            this.reset();
        } else {
            // Error
            formMessage.textContent = result.detail || 'Failed to send message. Please try again.';
            formMessage.className = 'p-4 rounded-lg bg-red-100 text-red-700 border border-red-200';
        }
    } catch (error) {
        // Network error
        formMessage.textContent = 'Network error. Please check your connection and try again.';
        formMessage.className = 'p-4 rounded-lg bg-red-100 text-red-700 border border-red-200';
    }
    
    // Reset button state
    submitBtn.textContent = originalText;
    submitBtn.disabled = false;
    formMessage.classList.remove('hidden');
    
    // Scroll to message
    formMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
});
</script>
{% endblock %} 